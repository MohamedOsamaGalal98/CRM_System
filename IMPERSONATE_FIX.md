# ุฅุตูุงุญ ูุดููุฉ ุงูุชุญุงู ุงููููุฉ - ุงูุชุญุฏูุซ ุงูุฃุฎูุฑ

## ุงููุดููุฉ ุงูุชู ุชู ุญููุง:
ุนูุฏูุง ุชุณุชุฎุฏู ููุฒุฉ "ุงูุชุญุงู ุงููููุฉ"ุ ูุงู ุงููุธุงู ูุนูุฏ ุชูุฌููู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ุจุฏูุงู ูู ุงูุฏุฎูู ูุจุงุดุฑุฉ ุจุญุณุงุจ ุงููุณุชุฎุฏู.

## ุงูุญููู ุงููุทุจูุฉ:

### 1. **ุฅูุดุงุก Controller ูููุตู ูุงูุชุญุงู ุงููููุฉ**
```php
// ImpersonationController.php
public function impersonate(Request $request, User $user)
{
    // ุญูุธ ูุนุฑู ุงููุฏูุฑ ุงูุญุงูู
    session(['impersonator_id' => Auth::id()]);
    
    // ุชุณุฌูู ุฎุฑูุฌ ูุงูู ูุฅุนุงุฏุฉ ุชุณุฌูู ุฏุฎูู
    Auth::logout();
    $request->session()->regenerate();
    Auth::login($user, true);
    
    return redirect('/admin');
}
```

### 2. **ุงุณุชุฎุฏุงู URL ุจุฏูุงู ูู Action ูู Filament**
ุจุฏูุงู ูู ุชูููุฐ ุงูููุฏ ุฏุงุฎู Filament Actionุ ุฃุตุจุญ ุงูุฒุฑ ููุฌู ูู URL ูููุตู:
```php
->url(fn ($record) => "/admin/impersonate/{$record->id}")
```

### 3. **ูุณุงุฑุงุช ูุญููุฉ ุจู Middleware**
```php
Route::middleware(['auth', 'web'])->group(function () {
    Route::get('/admin/impersonate/{user}', [ImpersonationController::class, 'impersonate']);
    Route::get('/admin/stop-impersonation', [ImpersonationController::class, 'stopImpersonation']);
});
```

### 4. **ุจุงูุฑ ุชูุจูู ูุฑุฆู**
```php
// ShowImpersonationBanner Middleware
- ูุนุฑุถ ุจุงูุฑ ุฃุตูุฑ ูู ุฃุนูู ุงูุตูุญุฉ
- ููุถุญ ุงููุณุชุฎุฏู ุงูุญุงูู ูุงููุฏูุฑ ุงูุฃุตูู
- ุฒุฑ ูุจุงุดุฑ ูุฅููุงู ุงูุชุญุงู ุงููููุฉ
```

### 5. **ุฅุตูุงุญ ูุณุงุฑ Login ุงูููููุฏ**
```php
Route::get('/login', function () {
    return redirect('/admin/login');
})->name('login');
```

## ููู ูุนูู ุงููุธุงู ุงูุขู:

### ุงูุจุฏุก ุจุงูุชุญุงู ุงููููุฉ:
1. ุงููุฏูุฑ ูุถุบุท "ุงูุชุญุงู ุงููููุฉ" โ
2. ุชุฃููุฏ ุงูุนูููุฉ โ
3. **ุงููุธุงู ูุนูู ุงูุขุชู:**
   - ุญูุธ ูุนุฑู ุงููุฏูุฑ ูู ุงูุฌูุณุฉ
   - ุชุณุฌูู ุฎุฑูุฌ ูุงูู ูู ุงูุญุณุงุจ ุงูุญุงูู
   - ุชุฌุฏูุฏ ุงูุฌูุณุฉ (ูุฃูุงู ุฃูุถู)
   - ุชุณุฌูู ุฏุฎูู ุจุญุณุงุจ ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ ูุน "Remember Me"
   - ุฅุนุงุฏุฉ ุชูุฌูู ูููุญุฉ ุงูุฅุฏุงุฑุฉ

### ุฃุซูุงุก ุงูุชุญุงู ุงููููุฉ:
- **ุจุงูุฑ ุชุญุฐูุฑู** ูู ุฃุนูู ูู ุตูุญุฉ โ๏ธ
- ุนุฑุถ ุงุณู ุงููุณุชุฎุฏู ุงูุญุงูู ูุงููุฏูุฑ ุงูุฃุตูู
- ุฒุฑ ุณุฑูุน ูุฅููุงู ุงูุชุญุงู ุงููููุฉ

### ุฅููุงุก ุงูุชุญุงู ุงููููุฉ:
- ุถุบุท ุฒุฑ "ุฅููุงู ุงูุชุญุงู ุงููููุฉ"
- ุชุณุฌูู ุฎุฑูุฌ ูุนูุฏุฉ ูููุฏูุฑ ุงูุฃุตูู
- ุฑุณุงูุฉ ุชุฃููุฏ ูุฌุงุญ ุงูุนูููุฉ

## ุงููุฑู ุจูู ุงููุธุงู ุงููุฏูู ูุงูุฌุฏูุฏ:

| ุงููุฏูู โ | ุงูุฌุฏูุฏ โ |
|---------|----------|
| Auth::login() ุฏุงุฎู Filament | Controller ูููุตู |
| ุนุฏู ุชุฌุฏูุฏ ุงูุฌูุณุฉ | ุชุฌุฏูุฏ ูุงูู ููุฌูุณุฉ |
| ุจุฏูู ุชูุจูู ูุฑุฆู | ุจุงูุฑ ูุงุถุญ ูู ูู ุตูุญุฉ |
| ุฅุนุงุฏุฉ ุชูุฌูู ูุตูุญุฉ Login | ุฏุฎูู ูุจุงุดุฑ ูููุญุฉ ุงูุฅุฏุงุฑุฉ |
| ูุนุงูุฌุฉ ุฃุฎุทุงุก ุถุนููุฉ | ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก |

## ุงูุฃูุงู ุงููุญุณู:

### 1. **ุงูุชุญูู ูู ุงูุตูุงุญูุงุช**
```php
if (!Gate::allows('impersonate_users')) {
    abort(403, 'ุบูุฑ ูุณููุญ ูู ุจุงูุชุญุงู ุงููููุฉ');
}
```

### 2. **ููุน ุงูุชุญุงู ุงููููุฉ ููููุณ**
```php
if (Auth::id() === $user->id) {
    return redirect()->back()->with('error', 'ูุง ููููู ุงูุชุญุงู ูููุฉ ููุณู');
}
```

### 3. **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**
```php
try {
    // ุนูููุฉ ุงูุชุญุงู ุงููููุฉ
} catch (\Exception $e) {
    session()->forget('impersonator_id');
    return redirect()->back()->with('error', 'ูุดู ูู ุงูุชุญุงู ุงููููุฉ');
}
```

### 4. **ุชูุจูู ูุฑุฆู ูุณุชูุฑ**
- ุจุงูุฑ ูููู ูู ุฃุนูู ูู ุตูุญุฉ
- ูุง ูููู ุฅุบูุงูู ุฃู ุชุฌุงููู
- ูุญุชูู ุนูู ูุนูููุงุช ูุงุถุญุฉ ูุฒุฑ ุงูุฅููุงุก

## ุงุฎุชุจุงุฑ ุงููุธุงู:

### ูููุฏูุฑูู:
1. ุณุฌู ุฏุฎูู ุจุญุณุงุจ: `superadmin@example.com` / `password`
2. ุงุฐูุจ ูุตูุญุฉ ุงููุณุชุฎุฏููู: `/admin/users`
3. ุงุถุบุท "ุงูุชุญุงู ุงููููุฉ" ุจุฌุงูุจ ุฃู ูุณุชุฎุฏู
4. ูุงุญุธ ุงูุจุงูุฑ ุงูุฃุตูุฑ ูู ุฃุนูู ุงูุตูุญุฉ
5. ุชุตูุญ ุงููุธุงู ูุงููุณุชุฎุฏู ุงููุญุฏุฏ
6. ุงุถุบุท "ุฅููุงู ุงูุชุญุงู ุงููููุฉ" ููุนูุฏุฉ

### ููุงุญุธุงุช:
- โ ูุง ููุฌุฏ ุฅุนุงุฏุฉ ุชูุฌูู ูุตูุญุฉ Login
- โ ุฏุฎูู ูุจุงุดุฑ ุจุญุณุงุจ ุงููุณุชุฎุฏู
- โ ุชูุจูู ูุงุถุญ ุฃุซูุงุก ุงูุชุญุงู ุงููููุฉ
- โ ุนูุฏุฉ ุขููุฉ ูููุฏูุฑ ุงูุฃุตูู
- โ ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก

ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ูุซุงูู! ๐
